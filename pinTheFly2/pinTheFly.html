<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1.0" />
  <title> Hitesh Lala </title>
  <link rel="icon" href="../assets/favicon.png" type="image/png">
  <link rel="stylesheet" href="../css/layout.css">
  <link rel="stylesheet" type="text/css" href="pinTheFly.css">
</head>

<body>
  <div class="mainwrapper">
    <header>
      <div class="header-wrap">
        <div class="header-img">
          <img alt="logo" src="../assets/favicon.png" type="image/png">
        </div>
        <div class="header-txt"> Hitesh Lala </div>
        <div class="spacer"></div>
        <div class="header-dropdown-menu hide" id="dropdown"></div>
        <div class="header-dropdown" id="barsicon">
          <svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="20" height="20">
            <path id="svg-bars-path"
              d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z">
            </path>
          </svg>
        </div>
        <div class="header-navigate" id="navigate"></div>
      </div>
    </header>

    <div class="pin-header">
      <h1>
        <img src='../assets/fly11.png'>&nbsp;&nbsp;
        <img src='../assets/swat1.cur'>&nbsp;&nbsp;
        <img src='../assets/fly12.png'>&nbsp;&nbsp;
        Swat The Flies&nbsp;&nbsp;
        <img src='../assets/fly12.png'>&nbsp;&nbsp;
        <img src='../assets/swat2.cur'>&nbsp;&nbsp;
        <img src='../assets/fly11.png'>
      </h1>
    </div>

    <div class="pin-center">
      <p>Try to Swat Those Pesky Flies Before They Escape!!</p>
      <p><input class="pin-input" id="numflies" type="number" value="50"> <input class="pin-input" onclick="pinflies()"
          type="button" value="Start Swatting" /></p>
    </div>

    <div class="pin-box">
      <div class="pin-center">
        <table width="700">
          <tr>
            <th>Original Flies:</th>
            <th id="flyCount">0</th>
            <th>Swatted Flies:</th>
            <th id="pinned">0</th>
            <th>Escaped Flies:</th>
            <th id="escaped">0</th>
          </tr>
        </table>
      </div>
      <div class="pin-center">
        <canvas id="box" width="700" height="350" style="border: 2px solid black;">
        </canvas>
      </div>
      <div class="pin-forabsolute">
        <div class="pin-hide pin-result" id="pin-result">
          <div class="pin-x" onclick="clearResult()">X</div>
          <p>
            <img src='../assets/fly12.png'>: <span id='finalSwatted'></span>
            <img src='../assets/fly11.png' class="pin-left">: <span id='finalEscaped'></span>
          </p>
        </div>
      </div>
    </div>


    <div class="spacer"></div>

    <footer>
      <div>
        <p>
          <a href="https://hiteshlala.com"> &copy; Hitesh Lala</a> <span id="year"></span>
        </p>
      </div>
    </footer>
    <script src="pinTheFly.js"></script>
    <script>
      // add event listener for clicking on canvas
      var canv = document.getElementById('box');
      canv.addEventListener('click', didISwatAFly);
      canv.addEventListener('mouseup', flySwattUp);
      canv.addEventListener('mousedown', flySwattDown);

      // add sounds for swatting and for buzzing
      var sndswat = new Audio('../assets/whip2.mp3'),
        sndbuzz = new Audio('../assets/flyBuzzing1.mp3'),
        sndsquish = new Audio('../assets/scream1.mp3');


      // set up document variables
      document.pinned = [];
      document.flies = [];
      document.escaped = 0;

      // set up cursor image to change to swatter when over canvas
      document.getElementById("box").style.cursor = "url('../assets/swat1.cur'), auto";

      // reset the game variables and start playing
      var game;

      function pinflies() {
        document.pinned = [];
        document.flies = [];
        document.escaped = 0;
        var result = document.getElementById('pin-result');
        result.setAttribute('class', 'pin-result pin-hide');
        document.getElementById('flyCount').innerHTML = document.getElementById("numflies").value;
        createFlies();
        game = setInterval(drawCanvas, 20); // draw canvas every XXX ms
      }

      function clearResult() {
        var result = document.getElementById('pin-result');
        result.setAttribute('class', 'pin-result pin-hide');
      }

      // gets the x and y co-ordinates of cursor and passes it on to swatFly which
      //   checks to see if any fly was close to it
      function didISwatAFly(event) {
        swatFly(event.x, event.y);
      }

      // sets the curssor image and resets swat sound
      function flySwattUp() {
        document.getElementById("box").style.cursor = "url('../assets/swat1.cur'), auto";
        sndswat.currentTime = 0;
      }

      // sets the cursor image and starts swat sound
      function flySwattDown() {
        document.getElementById("box").style.cursor = "url('../assets/swat2.cur'), auto";
        sndswat.play();
      }
    </script>

    <script language="javascript">
      window.onload = () => {
        const date = document.getElementById('year');
        const drop = document.getElementById('dropdown');
        const nav = document.getElementById('navigate');
        const barsicon = document.getElementById('barsicon');

        date.innerText = `2016 - ${new Date().getFullYear()}`;

        const path = window.location.pathname.split('/');
        const page = path[path.length - 1];

        const menu = [{
            display: 'About',
            link: '../about.html',
            html: 'about.html'
          },
          {
            display: 'Code',
            link: '../index2.html',
            html: 'index2.html'
          }
        ];

        menu.forEach(function (m) {
          const menuitem = function (styleclass) {
            let style = page === m.html ? 'color:#525564;' : '';
            const adrop = document.createElement('a');
            adrop.setAttribute('href', m.link);
            adrop.setAttribute('style', style);
            adrop.setAttribute('class', styleclass);
            adrop.innerText = m.display;
            return adrop;
          };

          drop.appendChild(menuitem('nav-item-drop'));
          nav.appendChild(menuitem('nav-item'));
        });

        barsicon.onclick = function (e) {
          e.preventDefault();
          e.stopPropagation();
          const cssclass = drop.classList;
          let found = false;
          for (let i = 0; i < cssclass.length; i++) {
            found = found || cssclass[i] === 'hide';
          }
          if (found) {
            cssclass.remove('hide');
          } else {
            cssclass.add('hide');
          }
        };

        barsicon.ontouchstart = function (e) {
          e.preventDefault();
          e.stopPropagation();
          toggleDropdown();
        };

        window.addEventListener('resize', function () {
          drop.classList.add('hide');
        });
      };
    </script>

  </div>
</body>

</html>